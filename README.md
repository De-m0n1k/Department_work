# Department_work
My programs made for my department in MSU (IIT)

Аргументы в программе рассчитаны на полный (абсолютный) путь к файлам в виде "C:/Users/PC/AppData/Local/Microsoft/WindowsApps/python3.10.exe c:/Users/PC/Desktop/Python/IIT_2Course/test3.py "C:\Users\PC\Desktop\Python\IIT_2Course\input.csv"  "C:\Users\PC\Desktop\Python\IIT_2Course\config.xml" "

Описание методов и функций:
1)time_to_msec и msec_to_time - функции для перевода времени в формате string "hhmmss{ms}{ms}{ms}" в int, отвечающий за кол-во мс в данном времени, и наоборот. Нужны для формирования свеч
2)mapper - основная функция для map'а. Округляет время до начала ближайшей свечи (относит время к свече)
3)ohlc - функция, переводящая ряд вида ((Название инструмента, начало свечи), [список всех сделок за время свечи]) в OHLC вид

Описание самой программы:
Основная идея - группировать по ключу 2 раза и обрабатывать value.

Сначала считывается и обрабатывается xml файл (если его нет, ставятся дефолтные значения). Затем читается df, фильтруется по константам (временным). Затем делаю groupByKey (ключ - название инструмента), округляю время до начала свечи и после преобразования rdd из вида Row(SYMBOL, CANDLE_START, MOMENT, PRICE) к виду ((SYMBOL, CANDLE_START), (MOMENT, PRICE)), группирую по ключу. После этого value будет списком всех сделок по ключу (по свече каждого инструмента), и после преобразования списка в вид строки OHLC я записываю строки в файл, относящийся к инструменту.

Я сортирую все файлы по времени.
